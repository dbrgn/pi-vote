using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows.Forms;
using Pirate.PiVote;
using Pirate.PiVote.Crypto;
using Pirate.PiVote.Serialization;

namespace Pirate.PiVote.Prover
{
  static class Program
  {
    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    [STAThread]
    static void Main()
    {
      var scText0 = "5E5069726174652E5069566F74652E43727970746F2E5369676E656460315B5B5069726174652E5069566F74652E43727970746F2E5369676E6174757265526571756573745369676E436865636B2C205069726174652E5069566F74655D5D1D0600002E5069726174652E5069566F74652E43727970746F2E5369676E6174757265526571756573745369676E436865636B545069726174652E5069566F74652E43727970746F2E5369676E656460315B5B5069726174652E5069566F74652E43727970746F2E5369676E436865636B436F6F6B69652C205069726174652E5069566F74655D5D51000000245069726174652E5069566F74652E43727970746F2E5369676E436865636B436F6F6B696572362CB7EEB7CE0820000000DD0DA907A9FFF81D7D703F92719B4305F55AC01D075CC5BFA6184C5B05DB6CD580000000498D0561549963949D10760873A16ECEA181D3A8A45ABE77A5FD767B30CF576B3B29D7E241BD2ABDB246919336385025F67E55D14B43655AC0A3C16E08192EB777BE48655B79EA3E0D670A0401306249FAE6D5F3A537ABF5BE6BCE890AC791E42CDA4A592D96EA20B4D5C9309B0CE738D16A2FBF5EC5ED8BF99553D463E28E31C8020000265069726174652E5069566F74652E43727970746F2E4E6F746172794365727469666963617465110000004E6F746172794365727469666963617465100000002D7E7C45C58EF447BB07997B1A7B16EF59173C71F2A1CE08940000000602000000A40000525341310004000001000100CD8913B13B8FFF26CE73D43E0E705346241A2C1B56F84954D1FF710CFC682B5EC5CEA98392E61F83A27574478313D2A5F371AC215C6371D57C8FC809C45C8D4405DF2579CABBAED797BC09C9BD961A4815D17EC0241BA2A90720F518D889794EBECAC6A017EFB91ABFE26AF0C3C62810BB70845E4C053CE4E3234E1F85E491A0800000004EC758CE2F72902F65DB1EE64B72E764362755C949063CC939570975D4E3556137307804D912B614DB78DEAE95A85034C738B0DB20E6AFD8F918AB95ACBBABD28D10FEF8133AA33AA7D3D60391F612A8AD3AA45369055E1F69819F3CD2E403187BDACBB86782CBC700121CE5E61C76D367D1EF865ADDA50F5DB4F71F59E0284E010000002E5069726174652E5069566F74652E43727970746F2E496E74333243657274696669636174654174747269627574650200000001000000010000001E5069726174652E5069566F74652E43727970746F2E5369676E6174757265100000008C33DCD9C1FF1543999CBBF89C4276C380000000128DE172CBED9DAF6FFBD2BEEB38E9E5F5DD9385698124A305D4C2DC59ABF7B6E8E97E0D174904607F0190721CF82882001CE438E9826B5B413A1711E76CBE3617C3833DA5401E4C55B9EEE7A7D90CC63F2A96819AEA05B0F9018AD998CA8D7DCFE177616493FC0D4831A14022FBE01097341FC888A243F8E104D40A9CEE7A49CDEA8E7BA4B7CE08DD114D10E214D2080000000049416C6578616E6465722041726E6F6C642C205072C3A4736964656E74205069726174656E7061727465692053742E2047616C6C656E20756E6420626569646520417070656E7A656C6C255069726174652E5069566F74652E43727970746F2E566F746572436572746966696361746510000000566F746572436572746966696361746510000000D51560C783027D4D984E30BE6F91DC3B71EB69A470FACE08940000000602000000A400005253413100040000010001007F125864EA8E573FC2DF1D920E7C4BC3204FD5FE72A1A6554679307C329E3EB0626BA6741EE145FB11EA2292EDCA4D2C9CE1C61B9B1A504AAA130F1051BECFA1D519B9C1866C8CBE39FF73C89B6405E119E95874F124F8BC79E5DA8EDDFC3B883C6A75D9E9E88D43D1E4077E79D62DF806479DB634FCABC9E9123675CFD02996800000005E675F4B5F5885B71A84425845BFCF8013DAE9B986D7CC961767D7B47B6BF970BAC35F556D03F108DE609429DC1FA27BE085EEE4D317EF9850B9B12BC3BFBFC2ACB8AB523D962546CCF09ED4B0FF8D75E593E8135F9F466452C5D220BC02E8E4574E6F7B1A4F443BBE2578A5B63EF23436FC9600396DD3F870DDD37E0305540A020000002E5069726174652E5069566F74652E43727970746F2E496E743332436572746966696361746541747472696275746502000000010000002E5069726174652E5069566F74652E43727970746F2E496E743332436572746966696361746541747472696275746501000000000000000000000000000000D66A88C5E20BCF088000000051E6CE5DB10832AA9710B775E82DCE68CAF398F3E17BCE13656E992E5796656572632267E781E286FEE9070827A9681D619FDA06D9E65F0B07009B4D27FCBF83C08BDCC9AB351CB1DE36A22D9BEDD7E794908B774BAD970F1656EE5ADDA3BB88B9CDFC6690FD61A4481A70386592EBAF92AD6AC4E173AC30A438E453B6D30DBB95020000265069726174652E5069566F74652E43727970746F2E536572766572436572746966696361746511000000536572766572436572746966696361746510000000044F44E85D2FC9469CBB701B98EA491494582D91D315CD08940000000602000000A400005253413100040000010001008DA8A80A9674D4D28B0597F89181C96A551619E801420D204C1A024DF4D3F532785DC049192D4A80ED6B35048B354B51E0652301AD143CC17B72427AE8B25942ACF8D4758521E701A929638A5D6E72DE5AE7A41A1FB646D3EF9D76A81CC58B943A6D0C4E5375A476041FAC33B5A7E4C6390DDF5B03B737E227BAD866044826AD8000000021A02C7E100DFD81BF8D31782C689BBB82E2D63921B924797E76F9A006A8FE878216ADFF684369E0275F35E75AAD62A3E4B917AA66F54A1FE3B0BE8B1D5543366DCE70569ACD23CD3597C599CF2FA3E76BF5F6BE0ADA6600357665D613C8531DBB673743A6380429EAC8888984B2E6F16752D7DA67BA68C69DC4562F1B5D836A010000002E5069726174652E5069566F74652E43727970746F2E496E74333243657274696669636174654174747269627574650200000000000000010000001E5069726174652E5069566F74652E43727970746F2E5369676E6174757265100000008C33DCD9C1FF1543999CBBF89C4276C3800000003293FAB2C8CDC86944AAC9BF0E13CB5D9C3C1C1D2E636FBAFC6A50688EC22EC79E2E091386412AB8460EA3F02B3CC64B3A95DA760F54D88191550EBAC9BD3FB48C9889F32652EE380DAE44712D0E0F45F54A198EB6C2DAE967985B4DC4F86567B9AC643C73DC3F551A9092C9B45462768FCF5078B34AEB227DECC550D2C3E66C17336E91D315CD0800C2B0E5AFB5CF08000000001650505320536572766572204365727469666963617465".FromHexString();
      var sc0 = Serializable.FromBinary<Serializable>(scText0);
      var scText1 = "5E5069726174652E5069566F74652E43727970746F2E5369676E656460315B5B5069726174652E5069566F74652E43727970746F2E5369676E6174757265526571756573745369676E436865636B2C205069726174652E5069566F74655D5DDF0500002E5069726174652E5069566F74652E43727970746F2E5369676E6174757265526571756573745369676E436865636B545069726174652E5069566F74652E43727970746F2E5369676E656460315B5B5069726174652E5069566F74652E43727970746F2E5369676E436865636B436F6F6B69652C205069726174652E5069566F74655D5D51000000245069726174652E5069566F74652E43727970746F2E5369676E436865636B436F6F6B696516D0A04A2DF5CE08200000001F93D3367699CC4E67225351C9953D484B5228E7C4294C5685557495EBE9B63880000000DA97F04476EC67C078BC77FC65B131AE3B53110A449900F2877358569A28FC18FD3175E8ECCE163259876CE21EA7DC6ABB2662BDD67C56D6D3E42AE4EDF4776C2696612F621242F877A0B273E1D4DF7389A654AD704E81D1CD17DC3C650F88EE2613A676AECABDB53B452DF00CB44A2A437657E606D6287254D26FBDA4DAF15D8A020000265069726174652E5069566F74652E43727970746F2E4E6F746172794365727469666963617465110000004E6F7461727943657274696669636174651000000031382FC7D54E6346ACC17EF7C446DA36617CF776FBA4CE08940000000602000000A40000525341310004000001000100A3032958AB87D8BBFD241B48FAAF00A3ABD924372BAE69F3CE5FD6067B2ECBF92669889D398D6BBA2C35318E4FDE930590C0A2A2D7C8B6D96D51605045D9408EBA2AB059E66C408375B726FC93955417F75BAADB6A924C74449534B5C19B983FE837DA8C1E875B2A0F5F49E0636AEF7F56562D4714F5BFAE02812DA6CC2817FA8000000068E36109539239AE276423DA84FA4668AEC661178C1D44746B2A36AB817FA813029697A8C5AD6551D6AF512800C072A00C21B85A540FA72432B3A8BF4D10AA9C875677C48AA06A4B15F53A0FE74535704C61BE14C871751903493ABDE5B3079FCA20116406FBC489C7C564EA1D5D537D2572BD483CCB50E5BB81C9E6AEE4C0AD010000002E5069726174652E5069566F74652E43727970746F2E496E74333243657274696669636174654174747269627574650200000001000000010000001E5069726174652E5069566F74652E43727970746F2E5369676E6174757265100000008C33DCD9C1FF1543999CBBF89C4276C3800000007108249D07CEBA9707D4F7C1990FF3BE81FB9C4FA14C9184C5AD1303EFE2898237D57E665424CBF4A82825C9428CC2A83DC6945D2AC18A2BA6E6199A2B5466E8739E7014165EF3751B74213150066BB1259707AB7B6345B4B3DF16FB48D611C18FC9BE793930354D1C913D2E299F1171E822FD7C2DCE2F7BA2BADC15E8AB6AA659898AFCA4B7CE08D8241D54F3ECD108000000000B4D617263656C2042617572255069726174652E5069566F74652E43727970746F2E566F746572436572746966696361746510000000566F746572436572746966696361746510000000D51560C783027D4D984E30BE6F91DC3B71EB69A470FACE08940000000602000000A400005253413100040000010001007F125864EA8E573FC2DF1D920E7C4BC3204FD5FE72A1A6554679307C329E3EB0626BA6741EE145FB11EA2292EDCA4D2C9CE1C61B9B1A504AAA130F1051BECFA1D519B9C1866C8CBE39FF73C89B6405E119E95874F124F8BC79E5DA8EDDFC3B883C6A75D9E9E88D43D1E4077E79D62DF806479DB634FCABC9E9123675CFD02996800000005E675F4B5F5885B71A84425845BFCF8013DAE9B986D7CC961767D7B47B6BF970BAC35F556D03F108DE609429DC1FA27BE085EEE4D317EF9850B9B12BC3BFBFC2ACB8AB523D962546CCF09ED4B0FF8D75E593E8135F9F466452C5D220BC02E8E4574E6F7B1A4F443BBE2578A5B63EF23436FC9600396DD3F870DDD37E0305540A020000002E5069726174652E5069566F74652E43727970746F2E496E743332436572746966696361746541747472696275746502000000010000002E5069726174652E5069566F74652E43727970746F2E496E7433324365727469666963617465417474726962757465010000000000000000000000000000004E04A1A3E40BCF0880000000876E821714DEC6CCF6FC917B6AAD59DE7D2871478E28A66F42BAC760E42791930D883F773B27D5C46E42EAB688B61DA5765FE302D8B5D31721DE09191EDEBC259D45133BB48473DD8CC0CB05E597D107039172D4C114076E634CA6DDE56C2302640C14F07083B1A8EA683FE423410ADCD09F990AFF3107F80F1DF13FBB3739A295020000265069726174652E5069566F74652E43727970746F2E536572766572436572746966696361746511000000536572766572436572746966696361746510000000044F44E85D2FC9469CBB701B98EA491494582D91D315CD08940000000602000000A400005253413100040000010001008DA8A80A9674D4D28B0597F89181C96A551619E801420D204C1A024DF4D3F532785DC049192D4A80ED6B35048B354B51E0652301AD143CC17B72427AE8B25942ACF8D4758521E701A929638A5D6E72DE5AE7A41A1FB646D3EF9D76A81CC58B943A6D0C4E5375A476041FAC33B5A7E4C6390DDF5B03B737E227BAD866044826AD8000000021A02C7E100DFD81BF8D31782C689BBB82E2D63921B924797E76F9A006A8FE878216ADFF684369E0275F35E75AAD62A3E4B917AA66F54A1FE3B0BE8B1D5543366DCE70569ACD23CD3597C599CF2FA3E76BF5F6BE0ADA6600357665D613C8531DBB673743A6380429EAC8888984B2E6F16752D7DA67BA68C69DC4562F1B5D836A010000002E5069726174652E5069566F74652E43727970746F2E496E74333243657274696669636174654174747269627574650200000000000000010000001E5069726174652E5069566F74652E43727970746F2E5369676E6174757265100000008C33DCD9C1FF1543999CBBF89C4276C3800000003293FAB2C8CDC86944AAC9BF0E13CB5D9C3C1C1D2E636FBAFC6A50688EC22EC79E2E091386412AB8460EA3F02B3CC64B3A95DA760F54D88191550EBAC9BD3FB48C9889F32652EE380DAE44712D0E0F45F54A198EB6C2DAE967985B4DC4F86567B9AC643C73DC3F551A9092C9B45462768FCF5078B34AEB227DECC550D2C3E66C17336E91D315CD0800C2B0E5AFB5CF08000000001650505320536572766572204365727469666963617465".FromHexString();
      var sc1 = Serializable.FromBinary<Serializable>(scText1);
      var scText2 = "5E5069726174652E5069566F74652E43727970746F2E5369676E656460315B5B5069726174652E5069566F74652E43727970746F2E5369676E6174757265526571756573745369676E436865636B2C205069726174652E5069566F74655D5D010600002E5069726174652E5069566F74652E43727970746F2E5369676E6174757265526571756573745369676E436865636B545069726174652E5069566F74652E43727970746F2E5369676E656460315B5B5069726174652E5069566F74652E43727970746F2E5369676E436865636B436F6F6B69652C205069726174652E5069566F74655D5D51000000245069726174652E5069566F74652E43727970746F2E5369676E436865636B436F6F6B6965B2770DE9CEC0CE0820000000D4D56C8A7ADCC94D99FA45116E037CF66E386A55C4968107AEDA5BEF5C7D365A800000004D1CD912F59552A63C8E35055D1F26EC0147A827617D1C564B19CC74F38F4598694F6821A5F80C0CFC950119234DD7C90719BA9CF9580E1FE93AD622BD8A82E62E841CD5E0166F94551BE6B405816CC9815E77A0AD775B49F4F5DA08635B5797A5E273DE8198F4D4727DFFCC3EBE4C948114B6748BB5C53BA32E201E953EAC2CAC020000265069726174652E5069566F74652E43727970746F2E4E6F746172794365727469666963617465110000004E6F7461727943657274696669636174651000000099C17FB49C049944810D40DF2CFBF05E18BBA174EDA1CE08940000000602000000A40000525341310004000011000000E73678DAF80784E1F4ADC7327117DA404CB4CD80AF37961503AF137220499AAA16D488F94F3559B8A33F98D105FA7DAB2F111564D5B2F88DAA9B76819860DD334202BFB23F18CCF1BAC9244BE1A658D3DFF29671A3B83C36BBC01A2E7D0CE7D533DD6731034BF3673B9E53C50AFF4551A17369FDF32D4AD521AF1AAF412C5798800000001E7E16E3F5E92E3B8850FFF6AF7F2CE508E9592EBDF06D3ED0F2EF640A9F4F3F91176B8B213950A3E3B841199B76763B47044C8579E6FE550C2074A96F5CC197465474D180AC11BD5E0957B01DA46F0A0B8D50D81996B24EE00DC7A99E50CC8809FDF1603CCA042F9DCE6DC62145FF70140BAD879E6A8D35623B85E9EBC498C6010000002E5069726174652E5069566F74652E43727970746F2E496E74333243657274696669636174654174747269627574650200000001000000010000001E5069726174652E5069566F74652E43727970746F2E5369676E6174757265100000008C33DCD9C1FF1543999CBBF89C4276C3800000005805FEEA560D3A21BA598900F3F2FD0AC39037518488A89317F3EEB522DB890A46A9EA3754300149FFF679B6B6AD1817889624416591ED9016143897A44E1149C8F416B6E6E98A2C5B2D2BF859C45E3114778FD1AE1B71DF9BF4A48A3C2CBAA5A2D08E632BC387221FC206EA6C22A29F513C03CF5C5B10828646C3CEA14A6BB843816D2CC6B6CE08802A8FCF60D6CF08000000002D446F6D696E696B20536368696C646B6E656368742C204E6F7461722C204265697369747A657220534741524149255069726174652E5069566F74652E43727970746F2E566F746572436572746966696361746510000000566F746572436572746966696361746510000000D51560C783027D4D984E30BE6F91DC3B71EB69A470FACE08940000000602000000A400005253413100040000010001007F125864EA8E573FC2DF1D920E7C4BC3204FD5FE72A1A6554679307C329E3EB0626BA6741EE145FB11EA2292EDCA4D2C9CE1C61B9B1A504AAA130F1051BECFA1D519B9C1866C8CBE39FF73C89B6405E119E95874F124F8BC79E5DA8EDDFC3B883C6A75D9E9E88D43D1E4077E79D62DF806479DB634FCABC9E9123675CFD02996800000005E675F4B5F5885B71A84425845BFCF8013DAE9B986D7CC961767D7B47B6BF970BAC35F556D03F108DE609429DC1FA27BE085EEE4D317EF9850B9B12BC3BFBFC2ACB8AB523D962546CCF09ED4B0FF8D75E593E8135F9F466452C5D220BC02E8E4574E6F7B1A4F443BBE2578A5B63EF23436FC9600396DD3F870DDD37E0305540A020000002E5069726174652E5069566F74652E43727970746F2E496E743332436572746966696361746541747472696275746502000000010000002E5069726174652E5069566F74652E43727970746F2E496E743332436572746966696361746541747472696275746501000000000000000000000000000000B8BD54E4E50BCF0880000000339FAEB2C5C715F0B17FEE879AF018869925251F410571B9370DE41AD82F5CB4FB36EE40E3AA62F1B1907BC26C23C3EF47A9211DE652F59DDB91C8F611E3EB9D189AB0CDCFDF2B9A62352DB2132AF0395C6341FA9C8D8DA3E8C7E616B51E3575667661788E61E3627986AADFDF3670B55123EDB0DF997FA234FAD7901938D9C995020000265069726174652E5069566F74652E43727970746F2E536572766572436572746966696361746511000000536572766572436572746966696361746510000000044F44E85D2FC9469CBB701B98EA491494582D91D315CD08940000000602000000A400005253413100040000010001008DA8A80A9674D4D28B0597F89181C96A551619E801420D204C1A024DF4D3F532785DC049192D4A80ED6B35048B354B51E0652301AD143CC17B72427AE8B25942ACF8D4758521E701A929638A5D6E72DE5AE7A41A1FB646D3EF9D76A81CC58B943A6D0C4E5375A476041FAC33B5A7E4C6390DDF5B03B737E227BAD866044826AD8000000021A02C7E100DFD81BF8D31782C689BBB82E2D63921B924797E76F9A006A8FE878216ADFF684369E0275F35E75AAD62A3E4B917AA66F54A1FE3B0BE8B1D5543366DCE70569ACD23CD3597C599CF2FA3E76BF5F6BE0ADA6600357665D613C8531DBB673743A6380429EAC8888984B2E6F16752D7DA67BA68C69DC4562F1B5D836A010000002E5069726174652E5069566F74652E43727970746F2E496E74333243657274696669636174654174747269627574650200000000000000010000001E5069726174652E5069566F74652E43727970746F2E5369676E6174757265100000008C33DCD9C1FF1543999CBBF89C4276C3800000003293FAB2C8CDC86944AAC9BF0E13CB5D9C3C1C1D2E636FBAFC6A50688EC22EC79E2E091386412AB8460EA3F02B3CC64B3A95DA760F54D88191550EBAC9BD3FB48C9889F32652EE380DAE44712D0E0F45F54A198EB6C2DAE967985B4DC4F86567B9AC643C73DC3F551A9092C9B45462768FCF5078B34AEB227DECC550D2C3E66C17336E91D315CD0800C2B0E5AFB5CF08000000001650505320536572766572204365727469666963617465".FromHexString();
      var sc2 = Serializable.FromBinary<Serializable>(scText2);

      Application.EnableVisualStyles();
      Application.SetCompatibleTextRenderingDefault(false);
      Application.Run(new Master());
    }
  }
}
